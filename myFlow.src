<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>myFlow Interactive Commander</title>
    <!-- Removed Tailwind CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="myFlow.css">    
</head>
<body>

    <!-- Header -->
    <header>
        <div class="header-inner">
            <div class="logo-area">
                <span class="logo-icon">&#9900;</span>
                <div>
                    <h1 class="app-title">Myflow Commander</h1>
                    <p class="app-subtitle">Env: Linux / Bash / Git / Vim</p>
                </div>
            </div>
            <nav class="nav-tabs">
                <button onclick="app.switchTab('workflow')" id="tab-workflow" class="tab-btn active">Workflow Engine</button>
                <button onclick="app.switchTab('analytics')" id="tab-analytics" class="tab-btn">Branch Analytics</button>
                <button onclick="app.switchTab('vim')" id="tab-vim" class="tab-btn">Vim Conflict Sim</button>
                <button onclick="app.switchTab('config')" id="tab-config" class="tab-btn">Setup & Config</button>
            </nav>
            <!-- Mobile indicator -->
            <button class="tab-btn" style="display: block; md:display:none" onclick="alert('Please view on a wider screen for full interactive features.')">
                Menu &#9776;
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">

        <!-- TAB 1: WORKFLOW ENGINE -->
        <div id="view-workflow" class="grid-layout-workflow">
            
            <!-- Intro (Full Width on Mobile, spans logic on desktop) -->
            <div class="intro-box amber col-span-2">
                <h2 class="section-title">Interactive Workflow Generator</h2>
                <p class="section-desc">
                    Gitflow relies on a strict branching model. Use this tool to generate the exact bash commands for any lifecycle event. 
                    Select an action below to see the required commands and an explanation of how data moves between branches.
                </p>
            </div>

            <table width=1300px>
                <tr>
                    <td width=20% valign=top>
            <!-- TopOfPanel -->
            <div class="card">
                <h3 class="section-title" style="font-size: 1rem; margin-bottom: 1rem; display: flex; align-items: center;">
                    <span style="background: #e5e7eb; width: 1.5rem; height: 1.5rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; margin-right: 0.5rem;">
                        1
                    </span>
                    Git
                </h3>

                <!-- Init Group -->
                <div class="control-group btn-group-amber">
                    <label class="control-label">Initialization</label>
                    <button onclick="app.setFlow('init')" class="btn-action">
                        <span class="main">Init Project</span>
                        <span class="sub">Create master & develop</span>
                    </button>
                </div>

                <!-- Feature Group -->
                <div class="control-group btn-group-amber">
                    <label class="control-label">Feature (Routine)</label>
                    <button onclick="app.setFlow('featureStart')" class="btn-action">
                        <span class="main">Start Feature</span>
                        <span class="sub">Branch off develop</span>
                    </button>
                    <button onclick="app.setFlow('featureFinish')" class="btn-action">
                        <span class="main">Finish Feature</span>
                        <span class="sub">Merge into develop</span>
                    </button>
                </div>

                <!-- Release Group -->
                <div class="control-group btn-group-purple">
                    <label class="control-label">Release (Scheduled)</label>
                    <button onclick="app.setFlow('releaseStart')" class="btn-action">
                        <span class="main">Start Release</span>
                        <span class="sub">Freeze develop</span>
                    </button>
                    <button onclick="app.setFlow('releaseFinish')" class="btn-action">
                        <span class="main">Finish Release</span>
                        <span class="sub">Merge to master & develop</span>
                    </button>
                </div>

                <!-- Hotfix Group -->
                <div class="control-group btn-group-red">
                    <label class="control-label">Hotfix (Emergency)</label>
                    <button onclick="app.setFlow('hotfixStart')" class="btn-action">
                        <span class="main">Start Hotfix</span>
                        <span class="sub">Patch production</span>
                    </button>
                    <button onclick="app.setFlow('hotfixFinish')" class="btn-action">
                        <span class="main">Finish Hotfix</span>
                        <span class="sub">Merge to master & develop</span>
                    </button>
                </div>
            </div>
                    </td>
                    <td width=60% valign=top>
            <!-- Terminal Output -->
            <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                <!-- Terminal -->
                <div class="terminal">
                    <div class="terminal-header">
                        <div class="dots">
                            <div class="dot dot-red"></div>
                            <div class="dot dot-yellow"></div>
                            <div class="dot dot-green"></div>
                        </div>
                        <span style="margin-left: 1rem; font-size: 0.75rem; color: var(--text-muted); font-family: monospace;">bash &mdash; vim</span>
                    </div>
                    <div class="terminal-content" id="terminal-content">
                        <span style="color: var(--text-muted);"># Select an operation on the left to generate commands...</span>
                    </div>
                </div>

                <!-- Context Box -->
                <div class="context-box">
                    <h4 class="context-title">
                        <span style="margin-right: 0.5rem;">&#8505;</span> Logic & Context
                    </h4>
                    <p id="logic-content" class="context-text">
                        Waiting for user input...
                    </p>
                </div>
            </div>
                    </td>
                    <td width=20% valign=top>
            <!-- TopOfPanel -->
            <div class="card">
                <h3 class="section-title" style="font-size: 1rem; margin-bottom: 1rem; display: flex; align-items: center;">
                    <span style="background: #e5e7eb; width: 1.5rem; height: 1.5rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; margin-right: 0.5rem;">
                        2
                    </span>
                    Vim
                </h3>

                <!-- Init Group -->
                <div class="control-group btn-group-amber">
                    <label class="control-label">Vim Motions</label>
                    <button onclick="app.setInfo('LineMovements')" class="btn-action">
                        <span class="main">Line Movements</span>
                        <!-- span class="sub">Moving Around</span -->
                    </button>
                    <button onclick="app.setInfo('WordMovements')" class="btn-action">
                        <span class="main">Word Movements</span>
                    </button>
                    <button onclick="app.setInfo('Navigation')" class="btn-action">
                        <span class="main">Navigation</span>
                    </button>
                </div>
            </div>
                    </td>
                </tr>
            </table>
        </div>

        <!-- TAB 2: BRANCH ANALYTICS -->
        <div id="view-analytics" class="grid-layout-analytics hidden">
            <div class="intro-box purple col-span-2">
                <h2 class="section-title">Branch Characteristics Analysis</h2>
                <p class="section-desc">
                    Understanding the "personality" of each branch type is crucial for maintaining a clean history. 
                    This visualization compares the 5 branch types across four key metrics to illustrate their intended usage patterns.
                </p>
            </div>

            <div class="card">
                <div class="chart-container">
                    <canvas id="branchRadarChart"></canvas>
                </div>
                <div class="mt-4 text-center" style="display: flex; justify-content: center; gap: 1rem; font-size: 0.75rem;">
                    <span class="flex items-center"><span style="width: 8px; height: 8px; background: var(--color-red); border-radius: 50%; display: inline-block; margin-right: 4px;"></span>Hotfix</span>
                    <span class="flex items-center"><span style="width: 8px; height: 8px; background: var(--color-blue); border-radius: 50%; display: inline-block; margin-right: 4px;"></span>Master</span>
                    <span class="flex items-center"><span style="width: 8px; height: 8px; background: var(--color-green); border-radius: 50%; display: inline-block; margin-right: 4px;"></span>Develop</span>
                </div>
            </div>

            <div style="padding-left: 1rem;">
                <h3 class="section-title">Metric Definitions</h3>
                <ul class="space-y-6" style="list-style: none; padding: 0;">
                    <li style="display: flex; align-items: baseline;">
                        <span style="font-weight: 700; width: 6rem; flex-shrink: 0;">Lifespan:</span>
                        <span style="font-size: 0.875rem; color: var(--text-body);">How long the branch exists. 'Master' and 'Develop' are infinite. 'Hotfix' is extremely short.</span>
                    </li>
                    <li style="display: flex; align-items: baseline;">
                        <span style="font-weight: 700; width: 6rem; flex-shrink: 0;">Stability:</span>
                        <span style="font-size: 0.875rem; color: var(--text-body);">The code's readiness for production. 'Master' is 100% stable. 'Feature' is volatile.</span>
                    </li>
                    <li style="display: flex; align-items: baseline;">
                        <span style="font-weight: 700; width: 6rem; flex-shrink: 0;">Frequency:</span>
                        <span style="font-size: 0.875rem; color: var(--text-body);">How often new branches of this type are created or committed to.</span>
                    </li>
                    <li style="display: flex; align-items: baseline;">
                        <span style="font-weight: 700; width: 6rem; flex-shrink: 0;">Risk:</span>
                        <span style="font-size: 0.875rem; color: var(--text-body);">The potential danger of merging this branch improperly. Hotfixes carry high risk due to urgency.</span>
                    </li>
                </ul>
                <div style="margin-top: 1.5rem; padding: 1rem; background: var(--border-light); border-radius: 0.25rem; font-size: 0.875rem; font-style: italic;">
                    "Notice how <strong>Feature</strong> branches are the opposite of <strong>Master</strong>: low stability, finite life, but high activity."
                </div>
            </div>
        </div>

        <!-- TAB 3: VIM CONFLICT SIM -->
        <div id="view-vim" class="grid-layout-vim hidden">
            <div class="intro-box green col-span-2">
                <h2 class="section-title">Vimdiff Simulator</h2>
                <p class="section-desc">
                    Resolving conflicts in Vim can be intimidating. Git opens a 4-way split when you run <code>git mergetool</code>.
                    Hover over the panels below to understand what they represent, and click the commands to see what they do.
                </p>
            </div>

            <!-- Vim Simulator -->
            <div>
                <div class="vim-grid">
                    <!-- Top Row -->
                    <div class="vim-pane" onmouseenter="app.explainVim('local')" onclick="app.vimAction('local')">
                        <div class="vim-pane-label">LOCAL (Top Left)</div>
                        <div class="mt-4 text-green">var x = "My Change";</div>
                        <div style="font-size: 0.7rem; color: var(--text-muted); margin-top: 0.5rem;">The file state on your current branch.</div>
                    </div>
                    <div class="vim-pane" onmouseenter="app.explainVim('base')" onclick="app.vimAction('base')">
                        <div class="vim-pane-label">BASE (Top Center)</div>
                        <div class="mt-4 text-gray">var x = "Old Value";</div>
                        <div style="font-size: 0.7rem; color: var(--text-muted); margin-top: 0.5rem;">The common ancestor before divergence.</div>
                    </div>
                    <div class="vim-pane" onmouseenter="app.explainVim('remote')" onclick="app.vimAction('remote')">
                        <div class="vim-pane-label">REMOTE (Top Right)</div>
                        <div class="mt-4 text-red">var x = "Their Change";</div>
                        <div style="font-size: 0.7rem; color: var(--text-muted); margin-top: 0.5rem;">The branch you are merging in.</div>
                    </div>

                    <!-- Bottom Row (Spans full width) -->
                    <div class="vim-pane" style="grid-column: span 3; border-top: 1px solid var(--text-body); grid-row: 2;">
                        <div class="vim-pane-label" style="background: white; color: black;">MERGED (Bottom)</div>
                        <div class="mt-4 font-mono text-sm">
                            <span class="text-gray">&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span><br>
                            <span id="vim-result" class="text-yellow font-bold">Conflict Marker... (Select a source to resolve)</span><br>
                            <span class="text-gray">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="vim-controls">
                <h3 style="color: var(--color-amber); font-weight: 700; font-size: 0.875rem; text-transform: uppercase; margin-bottom: 1rem; margin-top: 0;">Vim Command Palette</h3>
                <div class="space-y-3">
                    <button onclick="app.runVimCmd('next')" class="vim-btn vim-btn-gray">
                        <span>]c</span> <span style="color: var(--text-light);">Jump Next Conflict</span>
                    </button>
                    <button onclick="app.runVimCmd('prev')" class="vim-btn vim-btn-gray">
                        <span>[c</span> <span style="color: var(--text-light);">Jump Prev Conflict</span>
                    </button>
                    <div style="height: 1px; background: var(--text-body); margin: 0.5rem 0;"></div>
                    <button onclick="app.resolveVim('LO')" class="vim-btn vim-btn-green">
                        <span>:diffg LO</span> <span>Get Local</span>
                    </button>
                    <button onclick="app.resolveVim('BA')" class="vim-btn vim-btn-gray">
                        <span>:diffg BA</span> <span>Get Base</span>
                    </button>
                    <button onclick="app.resolveVim('RE')" class="vim-btn vim-btn-red">
                        <span>:diffg RE</span> <span>Get Remote</span>
                    </button>
                    <div style="height: 1px; background: var(--text-body); margin: 0.5rem 0;"></div>
                    <button onclick="app.runVimCmd('save')" class="vim-btn vim-btn-blue">
                        <span>:wqa</span> <span>Save & Quit</span>
                    </button>
                </div>
                <div id="vim-explanation" style="margin-top: 1rem; border-top: 1px solid var(--text-body); padding-top: 0.5rem; font-size: 0.75rem; color: var(--text-muted); min-height: 3rem;">
                    Hover over the grid or buttons to see details.
                </div>
            </div>
        </div>

        <!-- TAB 4: CONFIG & SETUP -->
        <div id="view-config" class="grid-layout-config hidden">
             <div class="intro-box blue col-span-2">
                <h2 class="section-title">Setup & Aliases</h2>
                <p class="section-desc">
                    Essential configuration for a Linux/Bash/Vim environment. Add these to your <code>~/.bashrc</code> or <code>.gitconfig</code>.
                </p>
            </div>

            <!-- Git Config -->
            <div class="card">
                <h3 class="section-title" style="border-bottom: 1px solid var(--border-light); padding-bottom: 0.5rem;">One-time Git Config</h3>
                <code class="code-block code-green">git config --global core.editor "vim"

git config --global merge.tool vimdiff
git config --global merge.conflictstyle diff3
git config --global mergetool.prompt false

git config --global user.name "Your Name"</code>
            </div>

            <!-- Aliases -->
            <div class="card">
                <h3 class="section-title" style="border-bottom: 1px solid var(--border-light); padding-bottom: 0.5rem;">Bash Aliases (.bashrc)</h3>
                 <code class="code-block code-blue">alias gs='git status'

alias ga='git add'
alias gc='git commit'
alias gcm='git commit -m'
alias gl='git log --graph --oneline --all'
alias gmd='git checkout develop'
alias gmm='git checkout master'</code>
            </div>

             <!-- Bashrc -->
             <div class="card col-span-2">
                <h3 class="section-title" style="border-bottom: 1px solid var(--border-light); padding-bottom: 0.5rem;">Bash Setup</h3>
                <p class="section-desc" style="font-size: 0.875rem; margin-bottom: 0.5rem;">.bashrc</p>
                 <pre>
                 <code class="code-block code-yellow">
                     source /home/mestes/.bashrc
                 </code>
                 </pre>
             </div>
             <!-- Vimrc -->
             <div class="card col-span-2">
                <h3 class="section-title" style="border-bottom: 1px solid var(--border-light); padding-bottom: 0.5rem;">Vim Setup</h3>
                <p class="section-desc" style="font-size: 0.875rem; margin-bottom: 0.5rem;">.vimrc</p>
                 <pre>
                 <code class="code-block code-yellow">
                     source /home/mestes/.vimrc
                 </code>
                 </pre>
             </div>


             <!-- Prompt -->
             <div class="card col-span-2">
                <h3 class="section-title" style="border-bottom: 1px solid var(--border-light); padding-bottom: 0.5rem;">Bash Prompt Integration</h3>
                <p class="section-desc" style="font-size: 0.875rem; margin-bottom: 0.5rem;">Add this function to show the current branch in your terminal prompt.</p>
                 <code class="code-block code-yellow">

parse_git_branch() {
     git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/ (\1)/'
}

export PS1="\u@\h \[\033[32m\]\w\[\033[33m\]\$(parse_git_branch)\[\033[00m\] $ "</code>
            </div>
        </div>

    </main>

    <footer>
        <p>Generated from "Git and Gitflow Cheat Sheet" Source Report.</p>
    </footer>

    <script>
        const zapp = {
            // Data Store: Workflow Command Logic
            flows: {
// Vim
                LineMovements: {
                title: "Movements Within A Line",
                cmds: [
                        "$       : Move cursor to the end of the line",
                        "0       : Move cursor to the beginning of the line",
                        "^       : Move cursor to first non-blank character in line",
                        "fx      : Find next occurrence of character 'x'",
                        "Fx      : Find previous occurrence of character 'x'",
                        "tx      : Go towards next occurrence of character 'x' (stops right before it)",
                        "Tx      : Go towards previous occurence of character 'x' (stops right before it)",
                        ";       : Repeat previous f, F, t, or T movement forwards",
                        ",       : Repeat previous f, F, t, or T movement backwards",
                ],
                logic: "Vim Motions"
                },

                WordMovements: {
                title: "Word Movements",
                cmds: [
                        "w       : Move cursor forwards to start of word (letters, digits, underscores)",
                        "W       : Move cursor forwards to start of WORD (non-blank characters)",
                        "b       : Move cursor backwards to start of word",
                        "B       : Move cursor backwards to start of WORD",
                        "e       : Move cursor forwards to end of word",
                        "E       : Move cursor forwards to end of WORD",
                        "ge      : Move cursor backwards to end of word",
                        "gE      : Move cursor backwards to end of WORD",
                ],
                logic: "Vim Motions"
                },

                Navigation: {
                title: "Navigation",
                cmds: [
                        ")       : Move cursor to next sentence",
                        "(       : Move cursor to previous sentence",
                        "}       : Move cursor to next paragraph",
                        "{       : Move cursor to previous paragraph",
                        "G       : Move cursor to last line of document",
                        "{num}G  : Move cursor to line {num}",
                        "{num}j  : Go {num} lines down",
                        "{num}k  : Go {num} lines up",
                        "H       : Move cursor to line at the top of the window",
                        "M       : Move cursor to the line at the middle of the window",
                        "L       : Move cursor to the line at the bottom of the window",
                        "%       : Find next parenthesis/bracket/brace and jump to match",
                        "[(      : Go to previous unmatched (",
                        "[{      : Go to previous unmatched {",
                        "])      : Go to next unmatched )",
                        "]}      : Go to next unmatched }",
                        "]m      : Go to next start of method (Java like languages)",
                        "]M      : Go to next end of method",
                        "[m      : Go to previous start of method",
                        "[M      : Go to previous end of method",
                        "Ctrl-F  : Move cursor forwards one full screen",
                        "Ctrl-B  : Move cursor backwards one full screen",
                        "Ctrl-D  : Move cursor down half a screen",
                        "Ctrl-U  : Move cursor up half a screen",
                ],
                logic: "Vim Styling and Profiling"
                },
// Git
                init: {
                    title: "Initialize Project",
                    cmds: [
                        "git init",
                        "git checkout -b master",
                        "git checkout -b develop",
                        "git push -u origin --all",
                        "",
                        "",
                        "",
                        "Utility",
                        "git push origin --delete <remote-branch>  : Delete Remote Branch"
                        "git branch -d <branch>                    : Delete Local Branch"
                    ],
                    logic: "Creates the two infinite lifetime branches: <strong>master</strong> (production) and <strong>develop</strong> (integration). Pushes both to remote."
                },
                featureStart: {
                    title: "Start Feature",
                    cmds: [
                        "git checkout develop",
                        "git pull origin develop",
                        "git checkout -b feature/my-new-feature"
                    ],
                    logic: "ALWAYS branch off <strong>develop</strong>. Features are for new code. Naming convention: <code>feature/name</code>."
                },
                featureFinish: {
                    title: "Finish Feature",
                    cmds: [
                        "git checkout develop",
                        "git merge --no-ff feature/my-new-feature",
                        "git branch -d feature/my-new-feature",
                        "git push origin develop"
                    ],
                    logic: "Merge back into <strong>develop</strong> using <code>--no-ff</code>. This forces a merge commit, preserving the history that a feature branch existed."
                },
                releaseStart: {
                    title: "Start Release",
                    cmds: [
                        "git checkout develop",
                        "git checkout -b release/1.0.0",
                        "# ... bump versions, changelog ..."
                    ],
                    logic: "Branch off <strong>develop</strong>. This 'freezes' the code. Only bug fixes and documentation tasks allowed here."
                },
                releaseFinish: {
                    title: "Finish Release",
                    cmds: [
                        "git checkout master",
                        "git merge --no-ff release/1.0.0",
                        "git tag -a v1.0.0 -m 'Release 1.0.0'",
                        "git checkout develop",
                        "git merge --no-ff release/1.0.0",
                        "git branch -d release/1.0.0",
                        "git push origin master develop --tags"
                    ],
                    logic: "<strong>CRITICAL:</strong> Merge to BOTH <strong>master</strong> (for deployment) and <strong>develop</strong> (to capture fixes). Tag the master commit."
                },
                hotfixStart: {
                    title: "Start Hotfix",
                    cmds: [
                        "git checkout master",
                        "git checkout -b hotfix/1.0.1"
                    ],
                    logic: "Branch off <strong>master</strong>. This is the only time you branch from master. Used for emergency production bugs."
                },
                hotfixFinish: {
                    title: "Finish Hotfix",
                    cmds: [
                        "git checkout master",
                        "git merge --no-ff hotfix/1.0.1",
                        "git tag -a v1.0.1 -m 'Hotfix 1.0.1'",
                        "git checkout develop",
                        "git merge --no-ff hotfix/1.0.1",
                        "git branch -d hotfix/1.0.1"
                    ],
                    logic: "Merge to BOTH <strong>master</strong> and <strong>develop</strong>. If a release branch exists, merge to release instead of develop."
                }
            }
        }


        // State Management
        const app = {
            state: {
                currentTab: 'workflow',
                vimResolved: false
            },


            // Navigation
            switchTab: (tabId) => {
                // Hide all views
                ['workflow', 'analytics', 'vim', 'config'].forEach(id => {
                    document.getElementById(`view-${id}`).classList.add('hidden');
                    document.getElementById(`tab-${id}`).classList.remove('active');
                });
                
                // Show selected
                document.getElementById(`view-${tabId}`).classList.remove('hidden');
                document.getElementById(`tab-${tabId}`).classList.add('active');

                // Trigger chart render if analytics tab
                if(tabId === 'analytics' && !app.chartRendered) {
                    app.renderChart();
                    app.chartRendered = true;
                }
            },

            // Workflow Engine Logic
            setInfo: (flowKey) => {
                const flow = zapp.flows[flowKey];
                const terminal = document.getElementById('terminal-content');
                const logic = document.getElementById('logic-content');

                // Clear
                terminal.innerHTML = "";
                
                // Add Comment
                const comment = document.createElement('div');
                comment.style.color = "var(--text-muted)";
                comment.style.marginBottom = "0.5rem";
                comment.innerText = `# ${flow.title}`;
                terminal.appendChild(comment);

                // Add Commands
                flow.cmds.forEach(cmd => {
                    const line = document.createElement('div');
                    line.className = "cmd-line";
                    // Colorize basic keywords using new semantic classes
                    let html = cmd
                        .replace(/^git/, '<span class="token-git">git</span>')
                        .replace(/checkout/, '<span class="token-cmd">checkout</span>')
                        .replace(/merge/, '<span class="token-merge">merge</span>')
                        .replace(/push/, '<span class="token-cmd">push</span>')
                        .replace(/--no-ff/, '<span class="token-flag">--no-ff</span>');
                    
                    line.innerHTML = `<span class="cmd-prompt"></span> ${html}`;
                    terminal.appendChild(line);
                });

                // Update Logic Box
                logic.innerHTML = flow.logic;
            },
            // Workflow Engine Logic
            setFlow: (flowKey) => {
                const flow = zapp.flows[flowKey];
                const terminal = document.getElementById('terminal-content');
                const logic = document.getElementById('logic-content');

                // Clear
                terminal.innerHTML = "";
                
                // Add Comment
                const comment = document.createElement('div');
                comment.style.color = "var(--text-muted)";
                comment.style.marginBottom = "0.5rem";
                comment.innerText = `# ${flow.title}`;
                terminal.appendChild(comment);

                // Add Commands
                flow.cmds.forEach(cmd => {
                    const line = document.createElement('div');
                    line.className = "cmd-line";
                    // Colorize basic keywords using new semantic classes
                    let html = cmd
                        .replace(/^git/, '<span class="token-git">git</span>')
                        .replace(/checkout/, '<span class="token-cmd">checkout</span>')
                        .replace(/merge/, '<span class="token-merge">merge</span>')
                        .replace(/push/, '<span class="token-cmd">push</span>')
                        .replace(/--no-ff/, '<span class="token-flag">--no-ff</span>');
                    
                    line.innerHTML = `<span class="cmd-prompt">$</span> ${html}`;
                    terminal.appendChild(line);
                });

                // Update Logic Box
                logic.innerHTML = flow.logic;
            },

            // Vim Sim Logic
            explainVim: (pane) => {
                const ex = document.getElementById('vim-explanation');
                if(pane === 'local') ex.innerText = "LOCAL (Top Left): The file as it exists on your current branch (the one you ran 'git merge' into).";
                if(pane === 'base') ex.innerText = "BASE (Top Center): The common ancestor. How the file looked before either branch changed it.";
                if(pane === 'remote') ex.innerText = "REMOTE (Top Right): The file coming from the other branch (the one you are merging).";
            },
            
            resolveVim: (source) => {
                const res = document.getElementById('vim-result');
                const ex = document.getElementById('vim-explanation');
                
                if (source === 'LO') {
                    res.innerHTML = 'var x = "My Change"; <span class="text-green font-bold text-xs">// Kept Local</span>';
                    res.className = "text-green font-bold";
                    ex.innerText = "Executed :diffg LO (Get Local). You chose your version.";
                } else if (source === 'BA') {
                    res.innerHTML = 'var x = "Old Value"; <span class="text-gray font-bold text-xs">// Reverted to Base</span>';
                    res.className = "text-gray font-bold";
                    ex.innerText = "Executed :diffg BA (Get Base). You discarded both changes.";
                } else if (source === 'RE') {
                    res.innerHTML = 'var x = "Their Change"; <span class="text-red font-bold text-xs">// Took Remote</span>';
                    res.className = "text-red font-bold";
                    ex.innerText = "Executed :diffg RE (Get Remote). You chose their version.";
                }
            },

            runVimCmd: (cmd) => {
                const ex = document.getElementById('vim-explanation');
                if(cmd === 'next') ex.innerText = "]c : Jumps cursor to the next conflict marker.";
                if(cmd === 'prev') ex.innerText = "[c : Jumps cursor to the previous conflict marker.";
                if(cmd === 'save') {
                    ex.innerText = ":wqa : Write (save) all buffers and Quit. Merge complete.";
                    setTimeout(() => alert("Merge Saved & Vim Closed!"), 200);
                }
            },

            // Chart Logic
            chartRendered: false,
            renderChart: () => {
                const ctx = document.getElementById('branchRadarChart').getContext('2d');
                new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: ['Lifespan', 'Stability', 'Activity Freq', 'Risk Level'],
                        datasets: [
                            {
                                label: 'Master',
                                data: [100, 100, 20, 10], // Long life, High stable, Low freq, Low risk (if locked)
                                borderColor: 'rgba(59, 130, 246, 1)',
                                backgroundColor: 'rgba(59, 130, 246, 0.2)',
                                borderWidth: 2
                            },
                            {
                                label: 'Develop',
                                data: [100, 60, 90, 30], // Long life, Med stable, High freq
                                borderColor: 'rgba(16, 185, 129, 1)',
                                backgroundColor: 'rgba(16, 185, 129, 0.2)',
                                borderWidth: 2
                            },
                            {
                                label: 'Feature',
                                data: [30, 20, 80, 20], // Short life, Low stable, High freq
                                borderColor: 'rgba(245, 158, 11, 1)',
                                backgroundColor: 'rgba(245, 158, 11, 0.2)',
                                borderWidth: 2
                            },
                            {
                                label: 'Hotfix',
                                data: [10, 50, 10, 90], // Tiny life, Med stable, Low freq, HIGH RISK
                                borderColor: 'rgba(239, 68, 68, 1)',
                                backgroundColor: 'rgba(239, 68, 68, 0.2)',
                                borderWidth: 2
                            }
                        ]
                    },
                    options: {
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 100,
                                ticks: { display: false },
                                grid: { color: '#e5e7eb' }
                            }
                        },
                        plugins: {
                            legend: { position: 'bottom' }
                        }
                    }
                });
            }
        };

        // Initialize default view
        app.setFlow('featureStart');
    </script>
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. NO Tailwind CSS used. -->
</body>
</html>
