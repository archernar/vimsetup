clone_all() {
    local repo_url="$1"
    
    # 1. Clone the repository
    git clone "$repo_url" || return 1
    
    # 2. Extract directory name from URL (simple parsing)
    local dir_name
    dir_name=$(basename "$repo_url" .git)
    
    cd "$dir_name" || return 1

    # 3. Iterate over remote branches
    # 'grep -v' filters out the 'HEAD ->' pointer line
    for remote in $(git branch -r | grep -v '\->'); do
        # Remove 'origin/' prefix to get the local name
        local branch_name="${remote#origin/}"
        
        # Avoid recreating the default branch (which already exists)
        if ! git show-ref --verify --quiet "refs/heads/$branch_name"; then
            echo "Creating local branch: $branch_name"
            git branch --track "$branch_name" "$remote"
        fi
    done
    
    # 4. Fetch everything to be sure and verify
    git fetch --all --prune
    echo "Done. All branches created:"
    git branch
}

clone_all "$1"

